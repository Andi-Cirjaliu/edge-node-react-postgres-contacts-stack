{
    "name":"Contacts Application Stack",
    "type":"stack",
    "stack_id":"contacts-app-stack",
    "platform":"kubernetes",
    "description":"",
    "logo":"_images/stack.png",
    "cover":"cover.md",
    "has_supporting_content":true,
    "meta":{
       "Language":[
          "Node.js"
       ],
       "Backend":[
          "Express (Node.js)"
       ],
       "Frontend":[
          "React"
       ],
       "Database":[
          "PostgreSQL"
       ],
       "Install time":[
          "10 minutes"
       ]
    },
    "commands":[
       {
          "description":"Create PGO Cluster",
          "exec":"export PGO_APISERVER_URL=https://127.0.0.1:32443 && pgo create cluster contacts --username pguser --password password -n pgo >> output.txt 2 >> &1"
       },
       {
          "description":"Clone the Sample Application Code",
          "exec":"cd /home/student/projects && git clone https://github.com/Andi-Cirjaliu/edge-node-react-postgres-contacts-deploy.git >> output.txt 2 >> &1"
       },
       {
          "description":"Replace .env with Backend IP and Port",
          "exec":"cd /home/student/projects/edge-node-react-postgres-contacts-deploy/frontend && export backend_port=30456 && sed -i \"s|ip|$ip_addr|\" .env && sed -i \"s|port|$backend_port|\" .env >> output.txt 2 >> &1"
       },
       {
          "description":"Create contacts-db service and its port",
          "exec":"cd /home/student/projects/edge-node-react-postgres-contacts-deploy/k8s && kubectl create -f contacts-service.yaml >> output.txt 2 >> &1"
       },
       {
          "description":"Wait for Contacts DB to spin up ",
          "exec":"until nc -z -v -w30 $ip_addr 30435; do echo \"Waiting for Contacts database connection...\"; sleep 5; done; >> output.txt 2 >> &1"
       },
       {
          "description":"Initialize DB",
          "exec":"cd /home/student/projects/edge-node-react-postgres-contacts-deploy && PGPASSWORD=password psql -U pguser -h $ip_addr -p 30435 contacts < initialize-db.sql >> output.txt 2 >> &1"
       },
       {
          "description":"Deploy Sample Application",
          "exec":"cd /home/student/projects/edge-node-react-postgres-contacts-deploy&& skaffold config set default-repo localhost:5000 && skaffold run >> output.txt 2 >> &1"
       }
    ],
    "content":[
       "contact-application-tutorial.md"
    ],
    "display":[
       {
          "name":"Developer Dashboard",
          "url":"##DNS.host##/codeserver",
          "enabled":true
       }
    ]
 }
 